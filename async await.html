<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>async/await</title>
    <style>
      *,
      html {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
        text-align: center;
      }
    </style>
  </head>
  <body>
    <header><h1>Async / Await</h1></header>
    <!-- 
    async / await

    async must be present, always return a promise
    await waits till promise is sattled
    error handling - try/catch block
 -->
    <script>
      //   const example = async () => {
      //     return "hello there";
      //   };
      //   const someFunc = async () => {
      //     const result = await example();
      //     console.log(result);
      //   };
      //   someFunc();

      const users = [
        { id: 1, name: "John" },
        { id: 2, name: "Susan" },
        { id: 3, name: "Anna" },
      ];

      const articles = [
        { userId: 1, articles: ["One", "two", "three"] },
        { userId: 2, articles: ["Four", "Five"] },
        { userId: 3, articles: ["Six", "Seven", "Eight"] },
      ];

      const getUser = (name) => {
        return new Promise((resolve, reject) => {
          const user = users.find((user) => user.name === name);

          if (user) {
            return resolve(user);
          } else {
            reject(`No such user with name "${name}" `);
          }
        });
      };

      const getArticles = (userId) => {
        return new Promise((resolve, reject) => {
          const userArticles = articles.find((user) => user.userId === userId);
          if (userArticles) {
            return resolve(userArticles.articles);
          } else {
            reject(`Wrong ID`);
          }
        });
      };

      const getData = async () => {
        try {
          const user = await getUser("Susan");
          if (user) {
            const articles = await getArticles(user.id);
          }
        } catch (error) {
          console.log(error);
        }
      };
      getData();
      //   getUser("Susan")
      //     .then((user) => console.log(user))
      //     .catch((err) => console.log(err));
    </script>
  </body>
</html>
